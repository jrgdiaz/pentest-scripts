#This script will loop through all the .nasl and .nbin files and look for references in other sources like exploitdb and packetstorm to find potential exploits.
#idea from https://avleonov.com/2017/11/02/exploitability-attributes-of-nessus-plugins-good-bad-and-vulners/
#"The use of external exploit databases can greatly help with the search of exploitable vulnerabilities detected by Nessus."

import os
from requests_html import HTMLSession

session = HTMLSession()
url = 'https://vulners.com'
path = 'C:\\ProgramData\\Tenable\\Nessus\\nessus\\plugins'
nessus_nasl = os.listdir(path)

for nasl in nessus_nasl:
        print("NASL: "+nasl)
        r = session.get(url+'/nessus/'+nasl)
        r.html.render(timeout = 20)
        references = r.html.find('.vulners-link-initial')
        for i in range(0,len(references)):
                reference = references[i].links.pop()
                if ('exploitdb' in reference) or ('packetstorm' in reference) or ('cve' in reference):
                        print(reference)



